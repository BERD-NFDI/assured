{% set data = load_data(path=data_path) %}
{% set items = data.news %}

<section class="w-full overflow-x-hidden py-12" style="background:#e19ec7;">
  <div class="mx-auto max-w-[100vw] w-full px-4">

    <h2 class="uppercase text-sm font-bold mb-6">
      {{ title | default(value="Latest News") }}
    </h2>

    <div class="w-screen max-w-[100vw] overflow-x-hidden">

      <div id="news-scroller"
           class="flex gap-6 overflow-x-auto scroll-smooth snap-x snap-mandatory no-scrollbar
                  w-screen max-w-[100vw] px-1">

        {% for news in items %}
        {% if news.pin == "true" %}

        {% set clean = news.anews | striptags | trim %}

        <article class="
          snap-start flex-shrink-0
          bg-white rounded-lg shadow
          p-6

          /* MOBILE = 1 card */
          w-[85%]

          /* TABLET = 2 cards */
          md:w-[48%]

          /* DESKTOP = 3 cards */
          lg:w-[31%]

          overflow-hidden
        ">

          <div class="flex flex-col h-full">

            <!-- META -->
            <p class="text-sm text-gray-600 mb-2">
              {% if news.by %}
              <span class="font-semibold">{{ news.by }}</span> •
              {% endif %}
              {{ news.date }}
            </p>

            <!-- TITLE -->
            <h3 class="text-lg font-bold mb-3 line-clamp-2">
              {{ news.title }}
            </h3>

            <!-- TRUNCATED TEXT BLOCK -->
            {% if clean | length > 220 %}
              <div class="text-gray-700 text-sm leading-relaxed mb-4 h-[110px] flex flex-col justify-between overflow-hidden">
                <span>{{ clean | truncate(length=220) | trim }}…</span>
                <span class="text-center text-gray-400 text-xs">• • •</span>
              </div>
            {% else %}
              <div class="text-gray-700 text-sm leading-relaxed mb-4 h-[110px] flex items-start overflow-hidden">
                <span>{{ clean }}</span>
              </div>
            {% endif %}

            <!-- LINK -->
            <div class="mt-auto pt-3 border-t">
              <a class="text-blue-600 hover:underline text-sm"
                 href="{{ news.originalurl | default(value='') }}" target="_blank">
                Read more →
              </a>
            </div>

          </div>
        </article>

        {% endif %}
        {% endfor %}

      </div>
    </div>

    <!-- BUTTONS -->
    <div class="flex justify-center items-center gap-6 mt-6">
      <button onclick="scrollNews(-1)"
              class="w-10 h-10 bg-black text-white rounded-full flex items-center justify-center">
        ←
      </button>

      <a href="/news/"
         class="bg-black text-white px-6 py-2 rounded-full text-sm font-semibold hover:bg-gray-800">
        VIEW ALL NEWS
      </a>

      <button onclick="scrollNews(1)"
              class="w-10 h-10 bg-black text-white rounded-full flex items-center justify-center">
        →
      </button>
    </div>

  </div>
</section>

<style>
.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

.line-clamp-2 {
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
</style>

<script>
function scrollNews(direction) {
  const scroller = document.getElementById("news-scroller");
  const card = scroller.querySelector("article");
  if (!card) return;

  const gap = 24; // Tailwind gap-6 (1.5rem)
  const cardWidth = card.getBoundingClientRect().width + gap;

  scroller.scrollBy({ left: direction * cardWidth, behavior: "smooth" });
}
</script>
